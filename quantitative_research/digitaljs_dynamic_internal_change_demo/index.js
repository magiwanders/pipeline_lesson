document.addEventListener('DOMContentLoaded', () => {
    buildSHEAS('embedded', document.getElementById('sheas_container'), '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')
})

document.onclick = () => {
    var inputs = circuit['sheas_container'].getInputCells().map((cell)=>{return cell.get('outputSignals').out.toNumber()}).slice(0,-2)
    var reduction = inputs.reduce((a, b)=>{return a+b})
    switch (reduction) {
        case 0: setOut(['0', '0']); break; 
        case 1: setOut(['1', '0']); break; 
        case 2: setOut(['0', '1']); break; 
        case 3: setOut(['1', '1']); break; 
        default: break;
    }
}

function setOut(out) {
    var d3vl = circuit['sheas_container']._display3vl
    circuit['sheas_container'].getInputCells()[3].setInput(d3vl.read('bin', out[0], 1))
    circuit['sheas_container'].getInputCells()[4].setInput(d3vl.read('bin', out[1], 1))
}

function toggle() {
    if (document.querySelector('#which').innerHTML == 'SLOW') {
        document.querySelector('#which').innerHTML = 'FAST'
        document.querySelector('#explanation').innerHTML = 'This implementation uses the most high level components that DigitalJS can provide, that is adders. Its propagation delay is between 2 and 3 steps.'
        load(get_full_adder_fast(), false)
    } else if (document.querySelector('#which').innerHTML == 'FUNCTIONAL') {
        document.querySelector('#which').innerHTML = 'SLOW'
        document.querySelector('#explanation').innerHTML = 'This is a first principles implementation using universal gates. The element can be inspected down to Nand gates. Its propagation delay is between 5 and 12 steps.'
        load(get_full_adder_slow(), false )
    } else if (document.querySelector('#which').innerHTML == 'FAST') {
        document.querySelector('#which').innerHTML = 'FUNCTIONAL'
        document.querySelector('#explanation').innerHTML = 'This implementation is bound to a javascript function, therefore its propagation delay is less than a step.'
        load(get_full_adder_empty(), false )
    }
}

function get_full_adder_fast() {
    return JSON.parse(LZString.decompressFromBase64('N4IgJgpgbglgxhAziAXKSUCMrQBsCGARhLqiPiADQgAuAngA4RkBCArjTQPYB2VIDAE5cG+AOb4aMXqgAM1HmwC2hfImYoQACwgAPfoRg1kKTAog0yFagy6Ij0vmhD6UAVnkg6qALQA2WQBfQOoMACYcEAJiUk1CfnomVg5uPhthUQkpGRRPRRU1DW09AyMTMxAeCzJ4mzsHHNBXD2pvUyCQ8GgAZkjokjI4BMYi9k4ZdJFxSUc5BWVVdTIdfWpDY1QKqstNIbr7bKcm1BavVAB2N2DQ6AAWPqIBzURlYaTNABl8JQZ+ISmsrNcvMCktNCtShtTOYdiAXko/vVDpFXLdzp42h5rl0oG4HjFBvhBIJvNREkUvj8/hlpsjgZUFoVliU1mVNjDCcTSQIkUDjig0RjfN0rp0MH58U8QAAzNi4XAAfXwYEgggV0rUNAVsjeRQAymxCHAYII4GwjNSATMcp4EPLyWRZfKlSqIGqNYhLPsGkcXKgwm43K1fKLOnBeFU4NxBCYANqgaXCBHOGBgMgYbB1QSwrgcECdbiRVPp6ASrOwijXBNJotpzThRHZsi5ywFri1ktQMs8ptxfMhatcZOgYv1nqNnN5tsdsddieDfuUQfDkCjnHd2y9kBwIkk/Nk9spus4vHlsgwPhVmU1o+djdcLfw/e0Q8j48Ye5nzQX/sAXWoLxGiaZpss4TqKsqqrqpqkQYPASCwdA2DOP0sTkLqyTjGkAg0oCNogosRQQqyUJbNUmjWDyBx8n6KA+JgshCnRmC3KKNxQBEKGPGhtS0CMmGpJamTWk4eSMmCxSrCA6zlByfbenS/L0YxwZ0QAHGxOK9FxBK7BhmhjIJkzCXSYmgkRLLSaBZGwnsVE+iivgMUxPgBtiH6SmhT5kvxnzfL8xm0kCZmEcyUkyeylTkXCrwKTRqKBqp9Eiu50B4jpUo7ly+kgJSAU4VapkEUy4KWRF0JRbZu7crY1GNLRrFBmcdGXKlc4ZWhkEKhEPnvCAACCKoOYFeFOBU5UjjwyFhNQF6cRULb+p09hiFUdaTchGq4Oos08JxW3qJ0tUOc4riYOiSWYAxbXnJ5NRsC8PBiMIbAMNqOXsIgACqT0vfl/wmcF1DPbmDBxmYmD/vZim0d0mBNW09HXWK0BqXdFEqgqmZ8X1g1gMNBWAzk42gRtkVzZFi0oGEy0wKtEDrauU2oAdEC7ft+DbRAR28vVqIuZgYQdGGEYQFGD5xsuM7rvOmiLdOt6zrdX5M4uUuK1pssgPLB7S+KWsU1eiZDnrSFazrL6m1AaMqxe2BGzeb6dj1PaTq2usaxgNuu+ee1q9eJue6j5tTh7TuzveW52/7xsrmuGDKz7cscDqCvhzin5J6rDuB+nCchzQ9th6u75pQbl6BL+wSBEAA==='))
}

function get_full_adder_slow() {
    return JSON.parse(LZString.decompressFromBase64('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'))
}

function get_full_adder_empty() {
    return JSON.parse(LZString.decompressFromBase64('N4IgJgpgbglgxhAziAXKSUCMrQBsCGARhLqiPiADQgAuAngA4RkBCArjTQPYB2VIDAE5cG+AOb4aMXqgAM1HmwC2hfImYoQACwgAPfoRg1kKTAog0yFagy6Ij0vmhD6UAWkyz5IOqg8AWAFYAX2DqDAAmHBACYlJNQn56JlYObj4bYVEJKRkUb0UVNQ1tPQMjEzMQHgsyRJs7BzzQVw8val93AA4QsPBoAGZo2JIyOCTGEvZOGUyRcUlHOQVlVXUyHX1qQ2NUKprLTXGG+1ynFr9Pb063CN7w6H9holHNRGUJlM0AGXwlBn4QnmOSW+RWRXWmk25V2pnMhxA7yUgMaZ2iriCgQ6lwG936UECzziY3wgkEvmoyRKv3+gKyCzRYOqq2KGzK2wqe3hJLJFIEqNBFxQmOx7gA7HiMAA2ImvEAAK0QAAI3AA+JVIz5TNKzAT0kF5AosyGlLYgHaVbmaRUq9Wak5Nc4uVARLrXHGS6Bi2XxBXKtVKuCk8la1IzDJ64GLQ3gtYlaEc2H7WrW/3qoO8lGnQXOlCu93i2ShB5QLo+qy2pWK0M/P4AubZaNOI0Q+Ps82cuHVFPkSvVh2MoVBUUBT1QACc5YSfeQlMmZBp9cjjcZLbjbLNFq53YRhBnWcd6NQw58fh6xfxninIDg+7nXxAi7pUdXsdZUPbW67BzGd/52eaXMTxuO5Qj6OBeBqOBuEEEwAG1QAAM2EZFnBgMAyAwb0GkEBEuA4EA+m4aJ0Mw6BCRwhEYD4YskJQkiMM0aUUVwsh8MsIiuAYsioCeSiyGowiwjorhUNAUimOgbB+M0djCMpLi0MY/EyxkkBBNokBkNE7jJKgKI1LkzjdPxSc1I04StPopSeKGQyCOMmy9KvcyaOCABdah3kIOAYEEOA2E7YBQiAA='))
}